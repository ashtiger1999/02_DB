-- 김영희 회원과 같은 지역에 사는 회원들의 지역명, 아이디, 이름, 등급명을 이름 오름차순으로 조회

SELECT AREA_NAME 지역명, MEMBER_ID 아이디, MEMBER_NAME 이름, GRADE_NAME 등급명
FROM TB_MEMBER
JOIN TB_GRADE ON(GRADE = GRADE_CODE)
JOIN TB_AREA ON(AREA_CODE = AREA_CODE) -- using을 사용하던가, 컬럼명 앞에 테이블명을 명시하던가
WHERE AREA_CODE = (SELECT AREA_CODE
									 FROM TB_MEMBER -- 메인쿼리와 서브쿼리의 컬럼을 분간하기 위해 별칭을 사용하는 것이 권장됨
								   WHERE 이름 = '김영희') -- 서브 쿼리의 컬럼명의 별칭을 이름으로 설정한 코드 내역이 없음, 따라서 member_name으로 정정해야함.
ORDER BY 이름 DESC; -- desc는 내림차순임. 오름차순으로 작성하는 것이 권장됨


SELECT local_name 지역명, emp_id 아이디, emp_name 이름, job_name 등급명
FROM employee
JOIN job on(employee.job_code = job.JOB_CODE)
LEFT JOIN department ON(dept_id = DEPT_CODE)
JOIN LOCATION ON(local_code = location_id)
WHERE location_id = (SELECT location_id
										 FROM EMPLOYEE 
										 LEFT JOIN department on(dept_id = dept_code)
										 WHERE emp_name = '노옹철')
ORDER BY 이름;


CREATE TABLE "TB_MEMBER" (
   MEMBER_ID VARCHAR2(20),
   MEMBER_PWD VARCHAR2(20),
   MEMBER_NAME VARCHAR2(30),
   GRADE number(14), -- '991213-1234567'
   AREA_CODE number(20)
);

INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('hong01', 'pass01', '홍길동', 10, 02);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('leess99', 'pass02', '이순신', 10, 032);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('ss50000', 'pass03', '신사임당', 30, 031);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('iu93', 'pass04', '아이유', 30, 02);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('pcs1324', 'pass05', '박철수', 12, 031);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('you_js', 'pass06', '유재석', 10, 02);
INSERT INTO "TB_MEMBER" (MEMBER_ID, MEMBER_PWD, MEMBER_NAME, GRADE, AREA_CODE)
VALUES ('kyh9876', 'pass07', '김영희', 20, 031);


CREATE TABLE "TB_GRADE" (
   GRADE_CODE number(20),
   GRADE_NAME VARCHAR2(30)
);

INSERT INTO "TB_GRADE" (GRADE_CODE, GRADE_NAME)
VALUES (10, '일반회원');
INSERT INTO "TB_GRADE" (GRADE_CODE, GRADE_NAME)
VALUES (20, '우수회원');
INSERT INTO "TB_GRADE" (GRADE_CODE, GRADE_NAME)
VALUES (30, '특별회원');

CREATE TABLE "TB_AREA" (
   AREA_CODE number(20),
   AREA_NAME VARCHAR2(30)
);

INSERT INTO "TB_AREA" (AREA_CODE, AREA_NAME)
VALUES (02, '서울');
INSERT INTO "TB_AREA" (AREA_CODE, AREA_NAME)
VALUES (031, '경기');
INSERT INTO "TB_AREA" (AREA_CODE, AREA_NAME)
VALUES (032, '인천');

DROP TABLE TB_GRADE;

SELECT * FROM TB_MEMBER;
SELECT * FROM TB_GRADE;
SELECT * FROM TB_AREA;


SELECT AREA_NAME 지역명, MEMBER_ID 아이디, MEMBER_NAME 이름, GRADE_NAME 등급명
FROM TB_MEMBER
JOIN TB_GRADE ON(GRADE = GRADE_CODE)
JOIN TB_AREA using (AREA_CODE)
WHERE AREA_CODE = (
    SELECT AREA_CODE FROM TB_MEMBER
    WHERE 이름 = '김영희')
ORDER BY 이름 DESC;



SELECT A.AREA_NAME 지역명, M.MEMBER_ID 아이디,M.MEMBER_NAME 이름, G.GRADE_NAME 등급명
FROM TB_MEMBER M
JOIN TB_AREA A ON (A.AREA_CODE=M.AREA_CODE)
JOIN TB_GRADE G ON (G.GRADE_CODE = M.GRADE)
WHERE M.AREA_CODE = (SELECT AREA_CODE FROM TB_MEMBER WHERE MEMBER_NAME ='김영희')
ORDER BY 이름;